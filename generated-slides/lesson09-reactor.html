<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Lektion 9 - Reactor &amp; WebFlux</title><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport"><link href="reveal.js-3.9.2/css/reveal.css" rel="stylesheet"><link href="reveal.js-3.9.2/plugin/title-footer/title-footer.css" rel="stylesheet"><link rel="stylesheet" href="reveal.js-3.9.2/css/theme/anderscore.css" id="theme"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css"><style>/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}</style><link href="reveal.js-3.9.2/lib/css/zenburn.css" rel="stylesheet"><script>document.write( '<link rel="stylesheet" href="reveal.js-3.9.2/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script><script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script></head><body><div class="reveal"><div class="slides"><section id="_lektion_9_reactor_webflux" data-state="no-title-footer"><h2>Lektion 9 - Reactor &amp; WebFlux</h2><div class="paragraph center"><p>Was verbirgt sich dahinter?</p></div></section>
<section><section id="_reaktive_systeme"><h2>Reaktive Systeme</h2></section><section id="_reactive_manifesto"><h2>Reactive Manifesto</h2><div class="paragraph"><p>Reaktive Systeme müssen stets</p></div>
<div class="ulist"><ul><li><p>antwortbereit (responsive) &#8594; 100% Online, garantierte Antwortzeiten</p></li><li><p>widerstandsfähig (resilient) &#8594; fehlertolerant</p></li><li><p>elastisch (elastic) &#8594; skalierbar</p></li><li><p>und nachrichtenorientiert (message driven) &#8594; asynchron, nicht blockierend</p></li></ul></div>
<div class="paragraph"><p>sein.</p></div>
<div class="paragraph"><p>&#8594; <a href="https://www.reactivemanifesto.org/de" class="bare">https://www.reactivemanifesto.org/de</a></p></div></section><section id="_qualitäten_reaktiver_systeme"><h2>Qualitäten reaktiver Systeme</h2><div class="paragraph"><p><span class="image"><img src="images/reactive-traits.svg" alt="reactive traits"></span></p></div></section><section id="_nicht_verwechseln_reaktive_websites"><h2>Nicht verwechseln: Reaktive Websites</h2><div class="paragraph"><p>Der Begriff <em>reactive</em> wird oft statt <em>responsive</em> für Weboberflächen verwendet.</p></div>
<div class="paragraph"><p><br></p></div>
<div class="paragraph"><p><strong>Responsive Websites</strong></p></div>
<div class="ulist"><ul><li><p>passen ihr Layout speziell auf den Gerätetyp an und</p></li><li><p>liefern auf jede Benutzeraktion unmittelbares Feedback.</p></li></ul></div></section></section>
<section id="_umsetzung_reaktiver_systeme_in_java"><h2>Umsetzung reaktiver Systeme in Java</h2><div class="paragraph heading"><p>Mittel zur Umsetzung:</p></div>
<div class="ulist"><ul><li><p>Verwendung von nicht-blockierenden APIs (<code>java.nio</code> oder nativ)</p></li><li><p>Zustandslose Serverprozesse</p></li><li><p>Reactive Streams (Backpressure)</p></li><li><p>Asynchrone Verarbeitung</p></li></ul></div></section>
<section><section id="_reactive_streams"><h2>Reactive Streams</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Reactive Streams is an initiative to provide a standard for
asynchronous stream processing with non-blocking back pressure.</p></div></blockquote><div class="attribution">&#8212; <a href="http://www.reactive-streams.org" class="bare">http://www.reactive-streams.org</a></div></div></section><section id="_implementierungen_für_die_jvm"><h2>Implementierungen für die JVM:</h2><div class="ulist"><ul><li><p>Akka Streams</p></li><li><p>RxJava</p></li><li><p>Vert.x</p></li><li><p>Reactor (Spring)</p></li></ul></div></section><section id="_bausteine"><h2>Bausteine</h2><div class="imageblock" style=""><img src="images/ReactiveStreams.svg" alt="ReactiveStreams" width="1200" height="350"></div>
<div class="paragraph"><p>Die Reactive Streams Interfaces entsprechen exakt dem <code>java.util.concurrent.Flow</code>
Interface, das es seit Java 9 gibt.</p></div>
<div class="paragraph"><p><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/util/concurrent/Flow.html">&#8594; Javadocs</a></p></div></section><section id="_protokoll"><h2>Protokoll</h2><div class="imageblock" style="text-align: center"><img src="images/Protokoll.svg" alt="Protokoll" width="1000" height="720"></div></section><section id="_reaktive_datentypen"><h2>Reaktive Datentypen</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:25%"><col style="width:25%"><col style="width:25%"><col style="width:25%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Anzahl</th><th class="tableblock halign-left valign-top">Klassisch</th><th class="tableblock halign-left valign-top">Java 8</th><th class="tableblock halign-left valign-top">Reactor</th></tr><tbody><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">0..1</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">einzelnes Objekt</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Mono&lt;T&gt;</p></td></tr><tr><th class="tableblock halign-left valign-top"><p class="tableblock header">0..*</p></th><td class="tableblock halign-left valign-top"><p class="tableblock">Collection</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Stream</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Flux&lt;T&gt;</p></td></tr></table>
<div class="paragraph"><p><code>Flux</code> und <code>Mono</code> implementieren beide das <code>Publisher</code> Interface</p></div></section></section>
<section id="_synchrone_vs_reaktive_programmierung"><h2>Synchrone vs. reaktive Programmierung</h2><div class="imageblock" style="text-align: center"><img src="images/sync-vs-reactive.svg" alt="sync vs reactive" height="800"></div></section>
<section><section id="_flux_mono_api"><h2>Flux &amp; Mono API</h2><div class="paragraph heading"><p>Mono erzeugen &#8230;&#8203;</p></div><pre class="CodeRay listingblock"><code class="java language-java">Mono.empty();
Mono.just(<span class="string"><span class="delimiter">&quot;</span><span class="content">blub</span><span class="delimiter">&quot;</span></span>);
Mono.justOrEmpty(mayBeNull);
Mono.justOrEmpty(someOptional);
Mono.fromCallable(<span class="local-variable">this</span>::toString);
Mono.error(<span class="keyword">new</span> <span class="exception">RuntimeException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">sample</span><span class="delimiter">&quot;</span></span>));
Mono.delay(<span class="predefined-type">Duration</span>.ofSeconds(<span class="integer">3</span>));</code></pre></section><section id="_flux_erzeugen"><h2>Flux erzeugen &#8230;&#8203;</h2><pre class="CodeRay listingblock"><code class="java language-java">Flux.empty();
Flux.just(<span class="integer">1</span>, <span class="integer">2</span> ,<span class="integer">3</span>);
Flux.range(<span class="integer">1</span>, <span class="integer">3</span>);
Flux.fromIterable(<span class="predefined-type">Arrays</span>.asList(<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>));
Flux.fromStream(IntStream.range(<span class="integer">1</span>, <span class="integer">3</span>).boxed());

Flux.error(<span class="keyword">new</span> <span class="exception">RuntimeException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">sample</span><span class="delimiter">&quot;</span></span>));
Flux.interval(<span class="predefined-type">Duration</span>.ofSeconds(<span class="integer">3</span>));</code></pre></section><section id="_operatoren"><h2>Operatoren &#8230;&#8203;</h2><pre class="CodeRay listingblock"><code class="java language-java">mono.log();
mono.subscribe(<span class="predefined-type">System</span>.out::println);
mono.block();</code></pre>
<div class="admonitionblock warning teacherBox"><table><tr><td class="icon"><i class="fa fa-warning" title="Warning"></i></td><td class="content">Jeder Operator erzeugt ein neues Objekt!</td></tr></table></div></section><section id="_callbacks"><h2>Callbacks &#8230;&#8203;</h2><pre class="CodeRay listingblock"><code class="java language-java">flux.doOnRequest(n -&gt; <span class="predefined-type">System</span>.out.println(n + <span class="string"><span class="delimiter">&quot;</span><span class="content">requested.</span><span class="delimiter">&quot;</span></span>));
flux.doOnNext(x -&gt; <span class="predefined-type">System</span>.out.print(<span class="string"><span class="delimiter">&quot;</span><span class="content">next: </span><span class="delimiter">&quot;</span></span> + x));
flux.doOnComplete(() -&gt; <span class="predefined-type">System</span>.out.println(<span class="string"><span class="delimiter">&quot;</span><span class="content">complete</span><span class="delimiter">&quot;</span></span>));
flux.doOnError(th -&gt; th.printStackTrace());</code></pre></section><section id="_konverter"><h2>Konverter &#8230;&#8203;</h2><pre class="CodeRay listingblock"><code class="java language-java">mono.map(x -&gt; x * <span class="integer">2</span>);
mono.filter(x -&gt; x &gt; <span class="integer">3</span>);
mono.flatMap(x -&gt; Mono.justOrEmpty(x * <span class="integer">2</span>));
mono.flux();</code></pre></section><section id="_kombinatoren"><h2>Kombinatoren &#8230;&#8203;</h2><pre class="CodeRay listingblock"><code class="java language-java">mono1.mergeWith(mono2);
mono1.zipWith(mono2);</code></pre></section><section id="_countdownlatch_verwenden"><h2>CountDownLatch verwenden &#8230;&#8203;</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="predefined-type">CountDownLatch</span> countDownLatch = <span class="keyword">new</span> <span class="predefined-type">CountDownLatch</span>(<span class="integer">1</span>);
Mono&lt;<span class="predefined-type">Long</span>&gt; delay = Mono.delay(<span class="predefined-type">Duration</span>.ofMillis(<span class="integer">500</span>));
delay.doOnTerminate(countDownLatch::countDown).subscribe();
countDownLatch.await();</code></pre></section><section id="_dokumentation"><h2>Dokumentation</h2><div class="ulist"><ul><li><p><a href="https://projectreactor.io/">&#8594; Project Reactor Website</a></p></li><li><p><a href="https://projectreactor.io/docs/core/release/reference/">&#8594; Project Reactor Referenzdokumentation</a></p><div class="ulist"><ul><li><p><a href="https://projectreactor.io/docs/core/release/reference/#core-features">&#8594; Abschnitt 4: Reactor Core Features</a></p></li></ul></div></li><li><p><a href="https://projectreactor.io/docs/core/release/api/index.html?reactor/core/publisher/Flux.html">&#8594; Javadocs zu Flux</a></p></li><li><p><a href="https://projectreactor.io/docs/core/release/api/index.html?reactor/core/publisher/Mono.html">&#8594; Javadocs zu Mono</a></p></li></ul></div></section></section>
<section id="_aufgabe_1_flux_und_mono_kennenlernen"><h2>Aufgabe 1: Flux und Mono kennenlernen</h2><div class="olist arabic"><ol class="arabic"><li><p>In der Klasse <code>reactor.basics.MonoTests</code> finden Sie ein Grundgerüst zu einem <em>Learningtest</em> zu <code>Mono</code>.
Bearbeiten Sie die darin mit <em>TODO</em> markierten Aufgaben.</p></li><li><p>Bearbeiten Sie die entsprechenden Aufgaben in <code>reactor.basics.FluxTests</code>.</p></li></ol></div></section>
<section><section id="_wozu_reaktive_progammierung"><h2>Wozu reaktive Progammierung?</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Synchron</th><th class="tableblock halign-left valign-top">Reaktiv</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Viele Threads</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Wenige Threads</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Viele gebundene Ressourcen</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Resourcesharing (gemeinsame Ressourcen)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Synchron (blockierend)</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Asynchron (nicht blockierend)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Stacktraces</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Schwer nachvollziehbare Abläufe</p></td></tr></table></section><section id="_ergo"><h2>Ergo:</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%"><col style="width:50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Synchron</th><th class="tableblock halign-left valign-top">Reaktiv</th></tr><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Einfach</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Kompliziert</p></td></tr></table>
<div class="paragraph"><p><br></p></div>
<div class="admonitionblock tip teacherBox"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">Reaktive Programmierung nur verwenden, wenn es wirklich Vorteile bringt.</td></tr></table></div></section></section>
<section><section id="_nichtblockierendes_io"><h2>Nichtblockierendes IO</h2><div class="paragraph heading"><p>Nichtblockierendes IO mit Java</p></div><div class="ulist"><ul><li><p>Bei Java NIO nur mit Sockets möglich</p></li><li><p>Meistens über native Implementierungen (z. B. hat Netty betriebsystemespezifische
Implementierung des <code>netty-transport</code> Moduls</p></li><li><p>Reaktive Datenbanktreiber bisher nur für einige NoSQL Datenbanken verfügbar</p></li><li><p>Gute Unterstützung für Messaging Systeme (Kafka, RabbitMQ, ActiveMQ)</p></li></ul></div></section><section id="_synchrones_lesen"><h2>Synchrones Lesen</h2><div class="imageblock" style="text-align: center"><img src="images/read-sync.svg" alt="read sync" width="800" height="780"></div></section><section id="_asynchrones_lesen"><h2>Asynchrones Lesen</h2><div class="imageblock" style="text-align: center"><img src="images/read-async.svg" alt="read async" width="800" height="720"></div></section><section id="_nio_selector"><h2>NIO Selector</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="predefined-type">ServerSocketChannel</span> server = <span class="predefined-type">ServerSocketChannel</span>.open();
server.socket().bind(<span class="keyword">new</span> <span class="predefined-type">InetSocketAddress</span>(SERVER_PORT));
server.configureBlocking(<span class="predefined-constant">false</span>); <i class="conum" data-value="1"></i><b>(1)</b>
server.register(selector, <span class="predefined-type">SelectionKey</span>.OP_ACCEPT); <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Lese- und Schreibzugriffe sind nicht blockierend</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td><code>Channel</code> beim <code>Selector</code> registrieren</td></tr></table></div></section><section id="_nio_selector_verwenden"><h2>NIO Selector verwenden</h2><pre class="CodeRay listingblock"><code class="java language-java"><span class="type">int</span> count = selector.select(); <i class="conum" data-value="1"></i><b>(1)</b>
<span class="predefined-type">Set</span>&lt;<span class="predefined-type">SelectionKey</span>&gt; selectedKeys = selector.selectedKeys();

<span class="predefined-type">Iterator</span>&lt;<span class="predefined-type">SelectionKey</span>&gt; iter = selectedKeys.iterator();
<span class="keyword">while</span> (iter.hasNext()) {
    <span class="predefined-type">SelectionKey</span> selectedKey = iter.next();
    <span class="keyword">if</span> (selectedKey.isAcceptable()) {
        handleNewClientConnection(selectedKey);
    } <span class="keyword">else</span> <span class="keyword">if</span> (selectedKey.isReadable()) {
        handleDataReceivedFormClient(selectedKey);
    }
    iter.remove();
}</code></pre>
<div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Warten bis auf irgendeinem <code>Channel</code> etwas anliegt</td></tr></table></div></section></section>
<section><section id="_reactive_streams_verwenden"><h2>Reactive Streams verwenden</h2><div class="paragraph heading"><p>IO mit Reactive Streams</p></div><div class="title">org.springframework.data.repository.reactive.ReactiveCrudRepository<br></div><pre class="CodeRay listingblock"><code class="java language-java">&lt;S <span class="directive">extends</span> T&gt; Mono&lt;S&gt; save(S entity);
&lt;S <span class="directive">extends</span> T&gt; Flux&lt;S&gt; saveAll(<span class="predefined-type">Iterable</span>&lt;S&gt; entities);
&lt;S <span class="directive">extends</span> T&gt; Flux&lt;S&gt; saveAll(Publisher&lt;S&gt; entityStream);
Mono&lt;T&gt; findById(ID id);
Mono&lt;T&gt; findById(Publisher&lt;ID&gt; id);
Mono&lt;<span class="predefined-type">Boolean</span>&gt; existsById(ID id);
Mono&lt;<span class="predefined-type">Boolean</span>&gt; existsById(Publisher&lt;ID&gt; id);
Flux&lt;T&gt; findAll();
Flux&lt;T&gt; findAllById(<span class="predefined-type">Iterable</span>&lt;ID&gt; ids);
Flux&lt;T&gt; findAllById(Publisher&lt;ID&gt; idStream);
Mono&lt;<span class="predefined-type">Long</span>&gt; count();
Mono&lt;<span class="predefined-type">Void</span>&gt; deleteById(ID id);
Mono&lt;<span class="predefined-type">Void</span>&gt; deleteById(Publisher&lt;ID&gt; id);
Mono&lt;<span class="predefined-type">Void</span>&gt; delete(T entity);
Mono&lt;<span class="predefined-type">Void</span>&gt; deleteAll(<span class="predefined-type">Iterable</span>&lt;? <span class="directive">extends</span> T&gt; entities);
Mono&lt;<span class="predefined-type">Void</span>&gt; deleteAll(Publisher&lt;? <span class="directive">extends</span> T&gt; entityStream);
Mono&lt;<span class="predefined-type">Void</span>&gt; deleteAll();</code></pre><div class="paragraph"><p>Verwendet nur Flux und Mono&#8230;&#8203;<br>
(Basisklasse für Zugriff auf NoSQL Datenbanken)</p></div><div class="paragraph"><p><a href="https://docs.spring.io/spring-data/commons/docs/2.2.6.RELEASE/api/org/springframework/data/repository/reactive/ReactiveCrudRepository.html">&#8594; Javadocs</a></p></div></section><section id="_eigene_publisher"><h2>Eigene Publisher</h2><div class="quoteblock"><blockquote><div class="paragraph"><p><a href="https://github.com/reactor/reactor-core/issues/482#issuecomment-287006634">
&#8594; Rule number 1 of the Reactor club: don&#8217;t write your own Publisher.
Even though the interface is simple, the set of rules about interactions
between all these reactive streams interface is not.</a></p></div></blockquote><div class="attribution">&#8212; Simon Baslé (Pivotal, Project Reactor)</div></div>
<div class="paragraph"><p><br></p></div>
<div class="admonitionblock important teacherBox"><table><tr><td class="icon"><i class="fa fa-exclamation-circle" title="Important"></i></td><td class="content">Eigene Publisher immer über Flux (create, push oder generate) erzeugen!</td></tr></table></div>
<div class="paragraph"><p>Siehe auch:</p></div>
<div class="ulist"><ul><li><p><a href="https://medium.com/@olehdokuka/mastering-own-reactive-streams-implementation-part-1-publisher-e8eaf928a78c">&#8594; Oleh Dokuka: Mastering own Reactive-Streams implementation</a></p></li><li><p><a href="https://www.packtpub.com/application-development/reactive-programming-spring-50">&#8594; Buch: Hands-On Reactive Programming in Spring 5</a></p></li></ul></div>
<aside class="notes"><div class="paragraph"><p>Quellennachweise für Grafiken:</p></div>
<div class="ulist"><ul><li><p><a href="https://pixabay.com/de/kaffee-kaffeemaschine-tasse-getr%C3%A4nk-880561/" class="bare">https://pixabay.com/de/kaffee-kaffeemaschine-tasse-getr%C3%A4nk-880561/</a></p></li><li><p><a href="https://images-na.ssl-images-amazon.com/images/I/51DWIpIIeaL" class="bare">https://images-na.ssl-images-amazon.com/images/I/51DWIpIIeaL</a>.<em>SY355</em>.jpg</p></li><li><p><a href="https://www.amazon.de/Jura-Impressa-Kaffeevollautomat-freistehend-Kaffeebohnen/dp/B00I8MYD5U" class="bare">https://www.amazon.de/Jura-Impressa-Kaffeevollautomat-freistehend-Kaffeebohnen/dp/B00I8MYD5U</a></p></li></ul></div></aside></section></section>
<section><section id="_aufgabe_2_webflux_und_brücken_zur_synchronen_welt_2_teile"><h2>Aufgabe 2: WebFlux und Brücken zur synchronen Welt (2 Teile)</h2><div class="olist arabic"><ol class="arabic"><li><p>Die <code>reactor.server.ReactorApplication</code> besteht im Moment aus einem REST-Controller,
mit einem <code>/hello</code> Handler und einer statischen <code>index.html</code>. Machen Sie sich mit
der Implementierung vertraut und führen Sie die Anwendung einmal aus.</p><div class="paragraph"><p>Zu dem Server gibt es eine passende Clientanwendung <code>reactor.client.HelloApiClient</code>.
Machen Sie sich auch mit deren Implementierung und Verwendung vertraut.</p></div></li><li><p>Solange nicht alle Teile eines Systems reaktiv sind, ist es notwendig synchrone,
blockierende Methodenaufrufe zu verwenden. Die Methode <code>slowSynchronousGreeting()</code>
simuliert so einen Methodenaufruf. Implementieren Sie analog zu dem <code>/hello</code> Handler
einen <code>/slow</code> Handler, der diese Methode für den Rückgabewert verwendet. Testen
Sie Ihre Implementierung mit <code>slow.html</code>. Was beobachten Sie?</p></li></ol></div><div class="admonitionblock tip teacherBox"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">Nutzen Sie <a href="https://projectreactor.io/docs/core/release/reference/#faq">&#8594; Appendix B: FAQ der Referenzdokumentation</a>!</td></tr></table></div></section><section id="_teil_2_datenströme"><h2>Teil 2: Datenströme</h2><div class="olist arabic"><ol class="arabic" start="3"><li><p>Implementieren Sie einen Handler <code>/countdown/{start}</code>, der im Sekundentakt von
<em>start</em> bis 0 herunterzählt und die jeweilige Zahl über einen Flux ausgibt. Zum
Testen können Sie die <code>countdown.html</code> verwenden.</p></li><li><p>Implementieren Sie analog zum <code>HelloApiClient</code> einen korrespondierenden
<code>CountDownApiClient</code>.</p></li><li><p>Eventhandler sind ein beliebtes Mittel um die Brücke zur synchronen Welt zu schlagen.
Der <code>ClockService</code> bietet die Möglichkeit, einen <code>ClockEventListener</code> zu registrieren,
der jede Sekunde ein <code>ClockEvent</code> mit der aktuellen Uhrzeit erhält. Implementieren Sie
einen <code>/clock</code> Handler, der fortlaufend (als <code>Flux</code>) die Uhrzeit ausgibt. Zum Testen
können Sie die <code>clock.html</code> verwenden.</p><div class="admonitionblock tip teacherBox"><table><tr><td class="icon"><i class="fa fa-lightbulb-o" title="Tip"></i></td><td class="content">Beachten Sie:
<a href="https://projectreactor.io/docs/core/release/reference/#producing.create">
&#8594; Referenzdokumentation: 4.4.2. Asynchronous &amp; multi-threaded: create</a></td></tr></table></div></li><li><p>Implementieren Sie einen <code>ClockApiClient</code>, der 10mal die Uhrzeit ausgibt und sich
danach beendet. Verwenden Sie dafür einen eigenen <code>BaseSubscriber</code>, der die <code>Subscription</code>
nach 10 ClockEvents cancelled.</p></li></ol></div></section></section>
<section id="_zusammenfassung_tag_5"><h2>Zusammenfassung Tag 5</h2><div class="ulist"><ul><li><p>Spring Security:</p><div class="ulist"><ul><li><p>Filter-Chain bei Webanwendungen</p></li><li><p>Zugriff auf Principal über SecurityContextHolder</p></li><li><p>Autorisierung über @PreAuthorize oder entsprechenden WebSecurityConfigurerAdapter</p></li><li><p>Login per OAuth2</p></li></ul></div></li><li><p>Reactor und WebFlux:</p><div class="ulist"><ul><li><p>Reactive Manifesto</p></li><li><p>Verwendung von Flux und Mono</p></li><li><p>Grundlagen der reaktiven Programmierung</p></li></ul></div></li></ul></div></section>
<section id="_abschluss"><h2>Abschluss</h2><div class="openblock heading"><div class="content"><div class="paragraph"><p>Fragen&#8230;&#8203;</p></div>
<div class="paragraph"><p>Anregungen&#8230;&#8203;</p></div>
<div class="paragraph"><p>Meinung&#8230;&#8203;</p></div>
<div class="paragraph"><p>Feedback&#8230;&#8203;</p></div></div></div>
<div class="paragraph"><p><a href="agenda.html">Inhalt</a></p></div></section></div></div><script src="reveal.js-3.9.2/lib/js/head.min.js"></script><script src="reveal.js-3.9.2/js/reveal.js"></script><script>// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display controls in the bottom right corner
  controls: true,
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: true,
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Enable slide navigation via mouse wheel
  mouseWheel: true,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  previewLinks: false,
  // Theme (e.g., beige, black, league, night, serif, simple, sky, solarized, white)
  // NOTE setting the theme in the config no longer works in reveal.js 3.x
  //theme: Reveal.getQueryHash().theme || 'anderscore',
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: Reveal.getQueryHash().transition || 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1728,
  height: 972,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js-3.9.2/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js-3.9.2/plugin/title-footer/title-footer.js', async: true, callback: function()
          {title_footer.initialize('Spring', 'Jan Lühr', 'anderScore GmbH • Frankenwerft 35 • 50667 Köln');}},
      { src: 'reveal.js-3.9.2/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js-3.9.2/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      
      { src: 'reveal.js-3.9.2/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js-3.9.2/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
  ]
});</script></body></html>